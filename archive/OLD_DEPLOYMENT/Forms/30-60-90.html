<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>30-60-90 Day Plan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <?!= include('Shared/CSS'); ?>
  </head>
  <body>
    <?!= include('Shared/Header'); ?>
    
    <div class="container">
      <h1>30-60-90 Day Onboarding Plan</h1>
      <p>Track milestones for: <strong><?= requestData['First Name'] ?> <?= requestData['Last Name'] ?></strong></p>
      
      <div class="form-section">
        <h2>Employee Information</h2>
        <table style="width: 100%; border-collapse: collapse;">
          <tr><td class="label" style="width: 40%; padding: 8px; border: 1px solid #ddd; background: #f5f5f5; font-weight: bold;">Request ID</td><td style="padding: 8px; border: 1px solid #ddd;"><?= requestData['Request ID'] ?></td></tr>
          <tr><td class="label" style="width: 40%; padding: 8px; border: 1px solid #ddd; background: #f5f5f5; font-weight: bold;">Name</td><td style="padding: 8px; border: 1px solid #ddd;"><?= requestData['First Name'] ?> <?= requestData['Last Name'] ?></td></tr>
          <tr><td class="label" style="width: 40%; padding: 8px; border: 1px solid #ddd; background: #f5f5f5; font-weight: bold;">Hire Date</td><td style="padding: 8px; border: 1px solid #ddd;"><?= requestData['Hire Date'] ?></td></tr>
          <tr><td class="label" style="width: 40%; padding: 8px; border: 1px solid #ddd; background: #f5f5f5; font-weight: bold;">Manager</td><td style="padding: 8px; border: 1px solid #ddd;"><?= requestData['Reporting Manager Email'] ?></td></tr>
        </table>
      </div>
      
      <form id="plan-form" onsubmit="handleSubmit(event)">
        <input type="hidden" name="Request ID" value="<?= requestData['Request ID'] ?>">
        <input type="hidden" name="Employee Name" value="<?= requestData['First Name'] ?> <?= requestData['Last Name'] ?>">
        
        <div class="form-section">
          <h2>30 Day Goals</h2>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="orientation" name="Orientation Complete" value="Yes">
            <label for="orientation">Company Orientation Complete</label>
          </div>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="training-30" name="Initial Training Complete" value="Yes">
            <label for="training-30">Initial Training Complete</label>
          </div>
          <div class="question-wrapper">
            <label for="notes-30">30 Day Notes</label>
            <textarea id="notes-30" name="30 Day Notes"></textarea>
          </div>
        </div>
        
        <div class="form-section">
          <h2>60 Day Goals</h2>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="independent-60" name="Working Independently" value="Yes">
            <label for="independent-60">Working Independently</label>
          </div>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="projects-60" name="First Projects Complete" value="Yes">
            <label for="projects-60">First Projects Complete</label>
          </div>
          <div class="question-wrapper">
            <label for="notes-60">60 Day Notes</label>
            <textarea id="notes-60" name="60 Day Notes"></textarea>
          </div>
        </div>
        
        <div class="form-section">
          <h2>90 Day Goals</h2>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="fully-productive" name="Fully Productive" value="Yes">
            <label for="fully-productive">Fully Productive</label>
          </div>
          <div class="question-wrapper checkbox-wrapper">
            <input type="checkbox" id="review-complete" name="90 Day Review Complete" value="Yes">
            <label for="review-complete">90 Day Review Complete</label>
          </div>
          <div class="question-wrapper">
            <label for="notes-90">90 Day Notes</label>
            <textarea id="notes-90" name="90 Day Notes"></textarea>
          </div>
        </div>
        
        <div class="question-wrapper">
          <label for="completed-by">Completed By *</label>
          <input type="text" id="completed-by" name="Completed By" required>
        </div>
        
        <div class="submit-container">
          <button type="submit" class="submit-btn">Submit 30-60-90 Plan</button>
        </div>
      </form>
      
      <div id="status-message"></div>
    </div>
    
    <?!= include('Shared/Footer'); ?>
    
    <script>
      function handleSubmit(event) {
        event.preventDefault();
        const statusDiv = document.getElementById('status-message');
        statusDiv.textContent = 'Submitting...';
        statusDiv.className = 'status-info';
        
        const formData = new FormData(event.target);
        const data = {};
        for (const [key, value] of formData.entries()) { data[key] = value; }
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
          data[cb.name] = cb.checked ? 'Yes' : 'No';
        });
        data['Completion Date'] = new Date().toISOString();
        
        google.script.run
          .withSuccessHandler(function(response) {
            statusDiv.className = 'status-success';
            statusDiv.textContent = response.message;
            if (response.status === 'success') document.getElementById('plan-form').reset();
          })
          .withFailureHandler(function(error) {
            statusDiv.className = 'status-error';
            statusDiv.textContent = 'Error: ' + error.message;
          })
          .process306090(data);
      }
    </script>
  </body>
</html>